IF
  OnCreation()
  Global("Reveal0300","AR0300",0)
THEN
  RESPONSE #100
    SetGlobal("Reveal0300","AR0300",1)
    Explore()
    Continue()
END

IF
  Global("PlayerThiefGuild","GLOBAL",1)
  Global("AddGuildNote","AR0300",0)
THEN
  RESPONSE #100
    AddMapNote([3078.2434],4636)  // ~<CHARNAME>'s Guildhall~
    SetGlobal("AddGuildNote","AR0300",1)
END

IF
  SpellCast([PC],0)
  !GlobalTimerNotExpired("SpellsBad","GLOBAL")
  Global("BribedCowled","GLOBAL",0)
  GlobalLT("CowledWarning","GLOBAL",7)
THEN
  RESPONSE #100
    CreateCreatureObjectDoor("COWENF2",LastTrigger,0,0,0)  // ~Cowled Enforcer~
    SetGlobalTimer("SpellsBad","GLOBAL",300)
END

IF
  SpellCast([PC],0)
  Global("BribedCowled","GLOBAL",0)
  GlobalTimerNotExpired("SpellsBad","GLOBAL")
THEN
  RESPONSE #100
    Wait(1)
END

IF
  OnCreation()
  Global("CloseDoorsFirstTime","AR0300",0)
THEN
  RESPONSE #100
    TriggerActivation("Tran0307a",FALSE)
    TriggerActivation("Tran0307b",FALSE)
    TriggerActivation("Info307a",TRUE)
    TriggerActivation("Info307b",TRUE)
    TriggerActivation("Tran0301",FALSE)
    TriggerActivation("Info301",TRUE)
    SetGlobal("CloseDoorsFirstTime","AR0300",1)
END

IF
  Global("PlayerThiefGuild","GLOBAL",0)
  Global("DisableThiefGuild","AR0300",0)
THEN
  RESPONSE #100
    TriggerActivation("Tran0321",FALSE)
    TriggerActivation("Tran0322",FALSE)
    TriggerActivation("Tran0323",FALSE)
    TriggerActivation("Tran0324a",FALSE)
    TriggerActivation("Tran0324b",FALSE)
    SetGlobal("DisableThiefGuild","AR0300",1)
END

IF
  Global("PlayerThiefGuild","GLOBAL",1)
  Global("EnableThiefGuild","AR0300",0)
THEN
  RESPONSE #100
    TriggerActivation("Tran0321",TRUE)
    TriggerActivation("Tran0322",TRUE)
    TriggerActivation("Tran0323",TRUE)
    TriggerActivation("Tran0324a",TRUE)
    TriggerActivation("Tran0324b",TRUE)
    TriggerActivation("Tran0301",FALSE)
    TriggerActivation("Info301",FALSE)
    TriggerActivation("Tran0302",FALSE)
    TriggerActivation("Tran0303a",FALSE)
    TriggerActivation("Tran0304a",FALSE)
    TriggerActivation("Tran0304b",FALSE)
    TriggerActivation("Tran0303",FALSE)
    CreateCreature("SHTHDR01",[3098.2574],2)  // ~Brannel~
    SetGlobal("EnableThiefGuild","AR0300",1)
END

IF
  Global("BodhiJob","GLOBAL",0)
  Global("DTG2Dave","AR0300",0)
THEN
  RESPONSE #100
    TriggerActivation("Tran0327",FALSE)
    TriggerActivation("Tran0328",FALSE)
    TriggerActivation("Tran0329a",FALSE)
    TriggerActivation("Tran0329b",FALSE)
    SetGlobal("DTG2Dave","AR0300",1)
END

IF
  GlobalGT("BodhiJob","GLOBAL",0)
  Global("ETG2Dave","AR0300",0)
THEN
  RESPONSE #100
    TriggerActivation("Tran0305",FALSE)
    TriggerActivation("Tran0306",FALSE)
    TriggerActivation("Tran0327",TRUE)
    TriggerActivation("Tran0328",TRUE)
    TriggerActivation("Tran0329",TRUE)
    TriggerActivation("Tran0307a",FALSE)
    TriggerActivation("Tran0307b",FALSE)
    TriggerActivation("Info307a",TRUE)
    TriggerActivation("Info307b",TRUE)
    SetGlobal("ETG2Dave","AR0300",1)
END

IF
  GlobalGT("JaheiraHarperPlot","GLOBAL",0)
  InParty("Jaheira")  // Jaheira
  !Dead("Jaheira")  // Jaheira
  Global("CloseHarperDoors","GLOBAL",1)
THEN
  RESPONSE #100
    SetGlobal("CloseHarperDoors","GLOBAL",0)
    Unlock("DOOR0308")
END

IF
  OR(2)
    !InParty("Jaheira")  // Jaheira
    Dead("Jaheira")  // Jaheira
  GlobalGT("JaheiraHarperPlot","GLOBAL",0)
  Global("CloseHarperDoors","GLOBAL",0)
THEN
  RESPONSE #100
    SetGlobal("CloseHarperDoors","GLOBAL",1)
    Lock("DOOR0308")
END

IF
  Global("ShadowWork","GLOBAL",1)
  Global("ShadowDoors","GLOBAL",0)
THEN
  RESPONSE #100
    SetGlobal("ShadowDoors","GLOBAL",1)
    Unlock("DOOR0305")
    Unlock("DOOR0306")
END

IF
  Global("WorkingForAran","GLOBAL",1)
  Global("ShadowSecretDoors","GLOBAL",0)
THEN
  RESPONSE #100
    Unlock("DOOR0305")
    Unlock("DOOR0306")
    TriggerActivation("Tran0307a",TRUE)
    TriggerActivation("Tran0307b",TRUE)
    TriggerActivation("Info307a",FALSE)
    TriggerActivation("Info307b",FALSE)
    SetGlobal("ShadowSecretDoors","GLOBAL",1)
END

IF
  Global("EdwinJob","GLOBAL",1)
  Global("CowledDoor","GLOBAL",0)
THEN
  RESPONSE #100
    SetGlobal("CowledDoor","GLOBAL",1)
    Unlock("DOOR0315")
    OpenDoor("DOOR0315")
    OpenDoor("GATE01")
END

IF
  Global("GorchOpen","GLOBAL",0)
THEN
  RESPONSE #100
    SetGlobal("GorchOpen","GLOBAL",1)
    TriggerActivation("TRAN0304B",FALSE)
    TriggerActivation("TRAN0301",FALSE)
    TriggerActivation("INFO301",TRUE)
END

IF
  Global("GorchOpen","GLOBAL",2)
THEN
  RESPONSE #100
    SetGlobal("GorchOpen","GLOBAL",3)
    Unlock("DOOR0303")
    Unlock("DOOR0304")
    TriggerActivation("TRAN0304B",TRUE)
    TriggerActivation("TRAN0301",TRUE)
    TriggerActivation("INFO301",FALSE)
END

IF
  Global("TalkedToLyros","GLOBAL",1)
  Global("RylockSpawn","GLOBAL",0)
  !Dead("Rylock")  // ~Rylock~
  !Exists("Rylock")  // ~Rylock~
THEN
  RESPONSE #100
    SetGlobal("RylockSpawn","GLOBAL",1)
    CreateCreature("RYLOCK",[1436.2947],13)  // ~Rylock~
    ActionOverride("Rylock",SetNumTimesTalkedTo(1))
END

IF
  OR(2)
    Global("LyrosJob","GLOBAL",3)
    Dead("lyros")  // ~Xzar~
  Exists("Rylock")  // ~Rylock~
  Global("RylockLeavesHarperDoor","AR0300",0)
THEN
  RESPONSE #100
    SetGlobal("RylockLeavesHarperDoor","AR0300",1)
    CloseDoor("DOOR0308")
    Lock("DOOR0308")
    ActionOverride("Rylock",EscapeArea())
END

IF
  Global("LyrosSpawn","GLOBAL",1)
THEN
  RESPONSE #100
    SetGlobal("LyrosSpawn","GLOBAL",2)
    CreateCreature("XZAR",[2372.2475],0)  // ~Xzar~
END

IF
  Global("EdwinJob","GLOBAL",1)
  Global("Door0315Locked","AR0300",0)
THEN
  RESPONSE #100
    Unlock("DOOR0315")
    SetGlobal("Door0315Locked","AR0300",1)
END

IF
  Global("BodhiJob","GLOBAL",1)
  Global("SpawnMook","AR0300",0)
THEN
  RESPONSE #100
    SetGlobal("SpawnMook","AR0300",1)
    CreateCreature("MOOK02",[1710.3625],12)  // ~Mook~
    CreateCreature("ARKANISG",[1642.3573],12)  // ~Arkanis Gath~
    CreateCreature("MOOKFT01",[1886.3659],12)  // ~Shadow Thief~
    CreateCreature("MOOKFT02",[1720.3560],0)  // ~Shadow Thief~
    CreateCreature("MOOKFT02",[1512.3564],0)  // ~Shadow Thief~
END

IF
  OR(2)
    TimeLT(DAWN_START)
    TimeGT(DUSK_START)
  Global("AranJob","GLOBAL",1)
  Global("SpawnMook","AR0300",0)
THEN
  RESPONSE #100
    SetGlobal("SpawnMook","AR0300",1)
    CreateCreature("MOOK",[1710.3625],12)  // ~Mook~
END

IF
  Global("TerminselSpawn","GLOBAL",2)
  GlobalLT("CloseHarperDoors","GLOBAL",2)
THEN
  RESPONSE #100
    Unlock("DOOR0308")
    SetGlobal("CloseHarperDoors","GLOBAL",2)
END

IF
  Global("SpawnBarg","GLOBAL",1)
THEN
  RESPONSE #100
    SetGlobal("SpawnBarg","GLOBAL",2)
    CreateCreature("NALBARG",[2399.2509],3)  // ~Barg~
END

IF
  OR(2)
    TimeLT(DAWN_START)
    TimeGT(DUSK_START)
  !Dead("Habib")  // ~Habib~
  Global("SpawnHabib","GLOBAL",0)
THEN
  RESPONSE #100
    SetGlobal("SpawnHabib","GLOBAL",1)
    CreateCreature("HABIB",[3476.425],2)  // ~Habib~
END

