IF
  AttackedBy([GOODCUTOFF],DEFAULT)
  Allegiance(Myself,NEUTRAL)
THEN
  RESPONSE #100
    Shout(89)
    Enemy()
    SetGlobal("KaylPartyHelped","GLOBAL",1)
END

IF
  Heard("kaysmg",89)  // kaysmg
  Allegiance(Myself,NEUTRAL)
THEN
  RESPONSE #100
    Enemy()
END

IF
  Heard("kaysmgl",89)  // kaysmgl
  Allegiance(Myself,NEUTRAL)
THEN
  RESPONSE #100
    Enemy()
END

IF
  Heard([0.0.HUMAN.THIEF],89)
  Allegiance(Myself,NEUTRAL)
THEN
  RESPONSE #100
    Enemy()
END

IF
  Global("KaylStartFight","GLOBAL",1)
  HaveSpell(CLERIC_ARMOR_OF_FAITH)
  OR(3)
    See(NearestEnemyOf(Myself))
    See("kaypall")  // kaypall
    See("kaypal")  // kaypal
THEN
  RESPONSE #100
    Spell(Myself,CLERIC_ARMOR_OF_FAITH)
    Continue()
END

IF
  Global("KaylStartFight","GLOBAL",1)
  HaveSpell(CLERIC_ENTANGLE)
  OR(3)
    See(NearestEnemyOf(Myself))
    See("kaypall")  // kaypall
    See("kaypal")  // kaypal
  !StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
  !StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
THEN
  RESPONSE #100
    Spell(LastSeenBy(Myself),CLERIC_ENTANGLE)
    Continue()
END

IF
  Global("KaylStartFight","GLOBAL",1)
  HPPercentLT(Myself,50)
  HaveSpell(CLERIC_CURE_SERIOUS_WOUNDS)
THEN
  RESPONSE #100
    Help()
    Spell(Myself,CLERIC_CURE_SERIOUS_WOUNDS)
    Continue()
END

IF
  Global("KaylStartFight","GLOBAL",1)
  HPPercentLT("kaysmgl",50)  // kaysmgl
  See("kaysmgl")  // kaysmgl
  HaveSpell(CLERIC_CURE_SERIOUS_WOUNDS)
THEN
  RESPONSE #100
    Spell(LastSeenBy(Myself),CLERIC_CURE_SERIOUS_WOUNDS)
    Continue()
END

IF
  Global("KaylStartFight","GLOBAL",1)
  HPPercentLT("kaysmg",30)  // kaysmg
  See("kaysmg")  // kaysmg
  HaveSpell(CLERIC_CURE_LIGHT_WOUNDS)
THEN
  RESPONSE #100
    Spell(LastSeenBy(Myself),CLERIC_CURE_LIGHT_WOUNDS)
    Continue()
END

IF
  Global("KaylStartFight","GLOBAL",1)
  HaveSpell(CLERIC_ARMOR_OF_FAITH)
  OR(2)
    See("kaysmgl")  // kaysmgl
    See("kaysmg")  // kaysmg
  CheckStatGT(LastSeenBy(Myself),2,ARMORCLASS)
THEN
  RESPONSE #100
    Spell(LastSeenBy(Myself),CLERIC_ARMOR_OF_FAITH)
    Continue()
END

IF
  Global("KaylStartFight","GLOBAL",1)
  HaveSpell(CLERIC_BARKSKIN)
  OR(3)
    See(NearestEnemyOf(Myself))
    See("kaypall")  // kaypall
    See("kaypal")  // kaypal
THEN
  RESPONSE #100
    Spell(Myself,CLERIC_BARKSKIN)
    Continue()
END

IF
  Global("KaylStartFight","GLOBAL",1)
  HaveSpell(CLERIC_HOLD_PERSON)
  !StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
  !StateCheck(NearestEnemyOf(Myself),STATE_HELPLESS)
  OR(3)
    See(NearestEnemyOf(Myself))
    See("kaypall")  // kaypall
    See("kaypal")  // kaypal
THEN
  RESPONSE #100
    Spell(LastSeenBy(Myself),CLERIC_HOLD_PERSON)
    Continue()
END

IF
  Global("KaylStartFight","GLOBAL",1)
  OR(3)
    See(NearestEnemyOf(Myself))
    See([NEUTRAL.0.HUMAN.FIGHTER])
    See([ENEMY.0.HUMAN.FIGHTER])
  !Dead("astSeenBy(Myself))")  // astSeenBy(Myself))
THEN
  RESPONSE #100
    EquipMostDamagingMelee()
    AttackReevaluate(LastSeenBy(Myself),30)
END

IF
  Dead("kaypall")  // kaypall
  NumDeadGT("kaypal",3)
  !See(NearestEnemyOf(Myself))
THEN
  RESPONSE #100
    EscapeArea()
END

