IF
  See([GOODCUTOFF])
  Global("hostile","LOCALS",0)
  Global("TanEnemy","GLOBAL",1)
  Allegiance(Myself,NEUTRAL)
THEN
  RESPONSE #100
    SetGlobal("hostile","LOCALS",1)
    Enemy()
END

IF
  OR(2)
    See([0.0.0.IMP])
    See(NearestEnemyOf(Myself))
  !StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
  GlobalLT("TANARIPARALYZE","LOCALS",3)
  !GlobalTimerNotExpired("TanariPar","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("TanariPar","LOCALS",6)
    IncrementGlobal("TANARIPARALYZE","LOCALS",1)
    ForceSpell(LastSeenBy(Myself),TANARI_PARALYZE)
END

IF
  See(NearestEnemyOf(Myself))
  OR(3)
    Class(LastSeenBy(Myself),MAGE_ALL)
    Class(LastSeenBy(Myself),CLERIC_ALL)
    Class(LastSeenBy(Myself),BARD_ALL)
  OR(2)
    HasBounceEffects(LastSeenBy(Myself))
    HasImmunityEffects(LastSeenBy(Myself))
  GlobalLT("dispels","LOCALS",5)
  !GlobalTimerNotExpired("PierceTan","LOCALS")
THEN
  RESPONSE #100
    SetGlobalTimer("PierceTan","LOCALS",12)
    ForceSpell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)
    IncrementGlobal("dispels","LOCALS",1)
END

IF
  See(NearestEnemyOf(Myself))
  !StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
  Global("Prep","LOCALS",1)
THEN
  RESPONSE #100
    ForceSpell(NearestEnemyOf(Myself),WIZARD_CONFUSION)
    SetGlobal("Prep","LOCALS",2)
END

IF
  See(NearestEnemyOf(Myself))
  RandomNum(10,1)
  !StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
  !StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
  Global("Prep","LOCALS",2)
THEN
  RESPONSE #100
    SpellNoDec(NearestEnemyOf(Myself),WIZARD_EMOTION_HOPELESSNESS)
    SetGlobal("Prep","LOCALS",3)
END

IF
  See(NearestEnemyOf(Myself))
  !StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
  GlobalLT("TANARIPARALYZE","LOCALS",7)
THEN
  RESPONSE #100
    IncrementGlobal("TANARIPARALYZE","LOCALS",1)
    ForceSpell(LastSeenBy(Myself),TANARI_PARALYZE)
END

IF
  OR(2)
    See([0.0.0.IMP])
    See(NearestEnemyOf(Myself))
  StateCheck(LastSeenBy,STATE_HELPLESS)
THEN
  RESPONSE #100
    AttackOneRound(LastSeenBy(Myself))
    AttackOneRound(LastSeenBy(Myself))
END

IF
  See([0.0.0.IMP])
THEN
  RESPONSE #100
    AttackReevaluate(LastSeenBy(Myself),30)
END

IF
  See(NearestEnemyOf(Myself))
THEN
  RESPONSE #100
    AttackReevaluate(LastSeenBy(Myself),30)
END

